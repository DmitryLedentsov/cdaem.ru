{#
    Просмотр апартаментов
    @var \yii\web\View this
    @var common\modules\agency\models\ApartmentAdvert model
    @var common\modules\agency\models\form\ReservationForm reservationForm
    @var common\modules\agency\models\form\DetailsHistoryForm detailsHistoryForm
#}

{% extends "@app/themes/basic/layouts/main.twig" %}

{% block title %} {{ model.meta_title }} {% endblock %}

{% block metaHead %}
    {% if model.advert_id == '211' or model.advert_id == '212' %}
        <!-- Yandex.Metrika counter -->
        <script type="text/javascript" >
            (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
                m[i].l=1*new Date();
                for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
                k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
            (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

            ym(90638807, "init", {
                clickmap:true,
                trackLinks:true,
                accurateTrackBounce:true,
                webvisor:true
            });
        </script>
        <noscript><div><img src="https://mc.yandex.ru/watch/90638807" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
        <!-- /Yandex.Metrika counter -->
    {% endif %}
{% endblock %}

{% block header %}
    <div id="map" style="width: 100%;  height: 300px" data-address="{{ model.apartment.address }}"></div>
    <div class="callbackbar-block">
        <div class="container">
            <div class="row">
                <div class="col-md-7 callback-title-link-block">
                    <span class="title-span">Квартиры от <a href="/" class="or-link">Сдаём.ру</a> без посредников - Москва</span>
                    <span class="call" data-toggle="modal" data-target="#modal-callback"></span>
                </div>
                <div class="col-md-2">
                    <div class="callback-phone-block">
                        <div class="row phone-1"><span class="c-phone">+7 (903) 799-17-99</span></div>
                        <div class="row phone-2"><span class="m-phone" style="">+7 (915) 455-94-94</span></div>
                    </div>
                </div>
                <div class="col-md-3 callback-btn-block">
                    <a href="{{ path(['/helpdesk/default/index']) }}" class="callback-btn">Связаться с диспетчером <br>
                        Cdaem.ru</a>
                </div>
            </div>

        </div>
    </div>
{% endblock %}

{% block breadcrumbs %}
    <div class="breadcrumbs">
        {{ use('yii/widgets/Breadcrumbs') }}

        {% set districts = model.apartment.mainDistrict.district_name %}
        {% if model.apartment.semiDistrict %}
            {% set districts = districts ~ '(' ~ model.apartment.semiDistrict.district_name ~ ')' %}
        {% endif %}


        {{ breadcrumbs_widget({
            'itemTemplate' : "<li>{link}</li>\n",
            'homeLink' :
            {
                'label' : 'Главная',
                'url' : '/'
            },
            'links':  [
                {
                    'label': 'Объявления Сдаем.ру',
                    'url' : '/agency'
                },
                {
                    'label': model.rentType.name,
                },
                {
                    'label': districts,
                },
            ],
        }) }}
    </div>
{% endblock %}

{% block navbarStickyHeader %}sticky-header{% endblock %}

{% block content %}
    {{ this.registerMetaTag({'name' : 'description', 'content' : model.meta_description}) }}
    {{ this.registerMetaTag({'name' : 'keywords', 'content' : model.meta_keywords}) }}

    {{ use('common/modules/geo/assets/frontend/YMapAsset') }}
    {{ register_y_map_asset() }}

    {{ use('common/modules/agency/assets/frontend/AgencyAsset') }}
    {{ register_agency_asset() }}

    {# Регистрация файлов для light box #}
    {{ use('frontend/themes/basic/assets/LightBoxAsset') }}
    {{ register_light_box_asset() }}

    {{ use('frontend/themes/basic/assets/SliderAsset') }}
    {{ register_slider_asset() }}

    {{ use('frontend/themes/basic/assets/WaterSliderAsset') }}
    {{ register_water_slider_asset() }}

    {{ this.render('@common/modules/agency/views/frontend/default/view/apartment.twig', {
        'model' : model,
        'reservationForm' : reservationForm,
        'detailsHistoryForm' : detailsHistoryForm,
    }) | raw }}
{% endblock content %}
